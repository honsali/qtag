<html>
<head>
    <title>Qtag 0.5</title>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/earlyaccess/notokufiarabic.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Amiri" rel="stylesheet">
    <link rel="stylesheet" href="style.css"/>
	<script type="text/javascript" src="canvas2image.js"></script>
	<script type="text/javascript" src="http://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
</head>
<body> 
	<script type="text/javascript">new Image().src='https://nullitics.com/n.gif?u=' + encodeURI(location.href) + '&r=' + encodeURI(document.referrer) + '&d=' + screen.width;</script>
	<div  id="viewer" style="text-align:center; font-size: 2em; padding: 20px; ">
	</div>
</body>
</html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="_data/data0.js"   type="text/javascript"></script>  
<script src="utils.js"    	type="text/javascript"></script>


<script type="text/javascript">
//is Web Share API supported?
// if ( navigator.share ) {

//   // share button click handler
//   document.getElementById('share').addEventListener('click', () => {

//     // share page information
//     navigator.share({
//       url: 'https://example.com/',
//       title: 'My example page',
//       text: 'An example page implementing the Web Share API.'
//     });

//   });

// }else{
// 	console.log("navigator.share not supported");
// }

	var c = _GET["c"]
	var v = _GET["v"];
	
	console.log(v);
	var vList = []; 
	console.log(_GET);
	if(c === undefined && v === undefined){
		console.log('nothing defined');
	}else if(v === undefined){				//case of no verse , only chapter
		c = parseInt(c);   
		var end = firstAyat[c+1] - firstAyat[c];
		for(var i=1; i < end+1; i++){
			vList.push(i);
		}
		console.log(vList);
	}else if(v.indexOf('-') > 0){				//case of sequence of verses
		var start = v.split('-')[0];
		var end = v.split('-')[1];
		for(var i=start; i <= end; i++){
			vList.push(i);
		}
	}else if(v.indexOf(',') > 0){				//case of enumeration of verses
		vList = v.split(',');
	}else if(c > 0 && c < 115 && v > 0){		//default case is one chapter and one verse specifically
		vList[0] = v;
	}else{
		vList[0] = v;
		console.log('unknown case');
		console.log(_GET);
	} 
 
	var result, result_en;
	for(var i=0; i < vList.length; i++){ 					//for each verse in the req, fetch it
		console.log(c);
		console.log(vList[i]);
		result = _.find(data, {sura: Number(c), aya: Number(vList[i])});
		result_en = _.find(data_en, {sura: Number(c), aya: Number(vList[i])});
		console.log(result);
		console.log(result_en);
		if(result === undefined)
			console.log('no result found for ' + vList[i]);
		else{ 
			div_result = document.createElement("div");
			div_result.innerHTML = result.text + "<br /> " + result_en.text;
// 			div_result.classList = "rtl";
			document.querySelector("#viewer").append(div_result);
		}
	}
</script>