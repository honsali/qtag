<html>
<head>
    <title>Qtag 0.5</title>
    <meta charset="UTF-8">
    <meta name="viewport"
          content="width=device-width, height=device-height, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"/>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.css" rel="stylesheet" />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css" rel="stylesheet" />
    <link href="https://fonts.googleapis.com/earlyaccess/notokufiarabic.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css?family=Amiri" rel="stylesheet">
    <link rel="stylesheet" href="style.css"/>
	<script type="text/javascript" src="canvas2image.js"></script>
	<script type="text/javascript" src="lib/html2canvas.min.js"></script>
</head>
<body> 
	<script type="text/javascript">new Image().src='https://nullitics.com/n.gif?u=' + encodeURI(location.href) + '&r=' + encodeURI(document.referrer) + '&d=' + screen.width;</script>
	<div  id="viewer" style="text-align:center; font-size: 2em; padding: 20px; ">
	</div>
	<canvas id="mycanvas"></canvas>
</body>
</html>

<script src="https://cdnjs.cloudflare.com/ajax/libs/underscore.js/1.8.3/underscore-min.js"></script>
<script src="_data/data0.js"   type="text/javascript"></script>  
<script src="utils.js"    	type="text/javascript"></script>

<script type="text/javascript">

	
	var c = 1, v=1; //these should be generated 
	
	var result = _.find(data, {sura: Number(c), aya: Number(v)});
	var result_en = _.find(data_en, {sura: Number(c), aya: Number(v)});

	console.log(result);
	console.log(result_en);
	
	div_result = document.createElement("div");
	div_result.innerHTML = result.text + "<br /> " + result_en.text;
//		div_result.classList = "rtl";
	document.querySelector("#viewer").append(div_result);
	
// 	var text_ = document.querySelector("#viewer div").innerHTML;
// 	var ctx = document.getElementById('mycanvas').getContext('2d');
// 	ctx.font = '12px serif';
// 	ctx.fillText(text_, 5, 5);
// 	var w = ctx.measureText(text_).width;
// 	var h = ctx.measureText(text_).height;

	html2canvas(document.querySelector("#viewer div")).then(canvas => {
		document.querySelector("#viewer").style.display ="none";
	    document.body.appendChild(canvas)
	    var dataUrl = canvas.toDataURL('image/jpeg', 1.0);
	    console.log(dataUrl);
	});


	//testing ground
	//Canvas2Image.saveAsImage(ctx, w, h);
</script>